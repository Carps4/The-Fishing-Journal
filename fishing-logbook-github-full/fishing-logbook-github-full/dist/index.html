<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>The Fishing Journal</title><style>:root{--bg1:#0f2a1f;--bg2:#25422f;--panel:rgba(255,255,255,0.04);--text:#f1efe6;--muted:#9fb2a7;--accent:#4f7b4f;--radius:10px}*{box-sizing:border-box}html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--text)}body{scroll-behavior:smooth}::selection{background:rgba(79,123,79,0.25)}.app-wrap{max-width:1100px;margin:18px auto;padding:18px}.header{display:flex;align-items:center;justify-content:center;position:relative;z-index:10010}.title{font-size:1.45rem;font-weight:700;text-align:center}.topbar{position:sticky;top:0;display:flex;align-items:center;justify-content:center;margin-top:12px;gap:20px;padding:10px;border-radius:var(--radius);background:linear-gradient(180deg,rgba(0,0,0,0.00),rgba(0,0,0,0.02));z-index:10005;pointer-events:auto}.tabs{display:flex;gap:12px}.tab{padding:10px 14px;border-radius:8px;cursor:pointer;color:var(--muted);touch-action:manipulation;user-select:none;background:transparent}.tab.active{background:rgba(255,255,255,0.03);color:var(--text);font-weight:600}.settings{position:fixed;right:12px;top:10px;z-index:10020}.settings button{padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--text);cursor:pointer;touch-action:manipulation}.card{background:var(--panel);padding:12px;border-radius:10px;margin-top:12px;box-shadow:0 6px 18px rgba(0,0,0,0.35)}.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}.input label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}.input input{width:100%;background:transparent;border:0;color:var(--text);padding:8px;border-radius:6px}.photos{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}.photo-thumb{width:64px;height:64px;border-radius:8px;object-fit:cover;border:1px solid rgba(255,255,255,0.03)}.schedule-wrap{overflow:auto;max-height:440px}.table{width:100%;border-collapse:collapse;min-width:900px}.table th,.table td{padding:8px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.03);font-size:13px}.table thead th{position:sticky;top:0;background:rgba(255,255,255,0.02)}.lake-card{padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);margin-bottom:8px;display:flex;justify-content:space-between;align-items:center}.notes-area{width:100%;min-height:120px;padding:10px;border-radius:8px;background:transparent;color:var(--text);resize:none;border:1px solid rgba(255,255,255,0.03)}.drawer{position:fixed;top:0;right:0;height:100%;width:420px;background:var(--panel);box-shadow:-20px 0 40px rgba(0,0,0,0.6);transform:translateX(100%);transition:transform 220ms ease-in-out;z-index:10025;padding:18px;overflow:auto;border-radius:12px 0 0 12px}.drawer.open{transform:translateX(0)}.footer-fixed{position:fixed;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;padding:8px 12px;background:transparent;color:rgba(241,239,230,0.7);font-size:13px}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-track{background:rgba(0,0,0,0.12);border-radius:8px}::-webkit-scrollbar-thumb{background:#3b5d3b;border-radius:8px}::-webkit-scrollbar-thumb:hover{background:#4f7b4f}@media(max-width:640px){.table{min-width:700px}.drawer{width:100%}}</style></head><body><div class="app-wrap"><div class="header"><div class="title">The Fishing Journal</div></div><div class="topbar" role="tablist" aria-label="Main tabs"><div class="tabs" id="tabs"><div class="tab active" data-tab="logbook" id="tab-logbook">Logbook</div><div class="tab" data-tab="lakes" id="tab-lakes">Lakes</div><div class="tab" data-tab="schedule" id="tab-schedule">Schedule</div></div></div><div class="settings"><button id="settingsBtn" title="Settings">⚙️</button></div><main id="panels"><section id="logbook" class="card panel" data-panel><div style="font-weight:600;margin-bottom:8px">Add New Catch</div><form id="entryForm" class="form-grid" autocomplete="off"><div class="input"><label>Time (24h)</label><input name="time" type="time"></div><div class="input"><label>Date (DD/MM/YY)</label><input name="date" type="date"></div><div class="input"><label>Species</label><input name="species" type="text" placeholder="e.g. Carp"></div><div class="input"><label>Weight (lb oz)</label><input name="weight" type="text" placeholder="e.g. 12lb 4oz"></div><div class="input"><label>Bait</label><input name="bait" type="text" placeholder="e.g. sweetcorn"></div><div class="input"><label>Name</label><input name="peg" type="text"></div><div class="input"><label>Lake</label><input name="lake" type="text"></div><div class="input"><label>Spot</label><input name="spot" type="text"></div><div style="grid-column:1/-1"><label class="small">Photos (max 4)</label><div><input id="photoInput" type="file" accept="image/*" multiple style="display:none"><button type="button" id="uploadBtn">Upload</button><div id="photoContainer" class="photos"></div></div></div><div style="grid-column:1/-1;display:flex;justify-content:flex-end"><button id="addBtn" type="button">Add Entry</button></div></form></section><section id="schedule" class="card panel" data-panel hidden><div style="font-weight:600;margin-bottom:8px">Catch History</div><div class="schedule-wrap"><table class="table" id="entriesTable"><thead><tr><th>Date</th><th>Time</th><th>Species</th><th>Weight</th><th>Lake</th><th>Name</th><th>Spot</th><th>Actions</th></tr></thead><tbody></tbody></table></div></section><section id="lakes" class="card panel" data-panel hidden><div style="font-weight:600;margin-bottom:8px">Lakes</div><div id="lakesContainer"></div><div style="margin-top:12px"><button id="showNotesBtn" class="small">Notes</button><div id="notesBox" style="display:none;margin-top:8px"><textarea id="notesArea" class="notes-area" placeholder="Notes for selected lake..."></textarea></div></div></section></main></div><div id="drawer" class="drawer" aria-hidden="true"><button id="closeDrawer" style="float:right;padding:8px;border-radius:8px;border:0;background:#111;color:white;cursor:pointer">✕</button><h3>Settings</h3><div style="padding:8px 0;display:flex;justify-content:space-between;align-items:center"><div>Dark mode</div><div><input id="darkToggle" type="checkbox"></div></div><div style="padding:8px 0"><button id="impExpBtn">Import / Export</button><div id="impExpMenu" style="display:none;margin-top:8px"><button id="importX" class="small">Import (.xlsx)</button><button id="exportX" class="small">Export (.xlsx)</button><button id="exportPdf" class="small">Export (.pdf)</button></div></div></div><div class="footer-fixed">Fishing Logbook v3.0 · © 2025</div><script>/* final app script: attach tabs, settings, storage */(function(){const q=(s)=>document.querySelector(s), qa=(s)=>Array.from(document.querySelectorAll(s));const tabs=qa('.tab'), panels=qa('[data-panel]'), settingsBtn=q('#settingsBtn'), drawer=q('#drawer'), closeDrawer=q('#closeDrawer');function switchTo(id){tabs.forEach(t=>t.classList.toggle('active', t.dataset.tab===id)); panels.forEach(p=>p.hidden = p.id !== id);}tabs.forEach(t=> t.addEventListener('click', ()=> switchTo(t.dataset.tab))); // ensure clickable on touch devices
settingsBtn.addEventListener('click', ()=> { drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); }); if(closeDrawer) closeDrawer.addEventListener('click', ()=> { drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); });
// theme
const darkToggle=q('#darkToggle'); const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches; darkToggle.checked = JSON.parse(localStorage.getItem('fj_dark') || JSON.stringify(prefersDark)); function applyTheme(d){ if(d){ document.documentElement.style.setProperty('--bg1','#0f2a1f'); document.documentElement.style.setProperty('--bg2','#25422f'); } else { document.documentElement.style.setProperty('--bg1','#f5f5f4'); document.documentElement.style.setProperty('--bg2','#e6efe9'); } localStorage.setItem('fj_dark', JSON.stringify(d)); } applyTheme(darkToggle.checked); darkToggle.addEventListener('change', ()=> applyTheme(darkToggle.checked));
// photos
const photoInput=q('#photoInput'), uploadBtn=q('#uploadBtn'), photoContainer=q('#photoContainer'); if(uploadBtn) uploadBtn.addEventListener('click', ()=> photoInput.click()); photoInput.addEventListener('change', e=>{ const files = Array.from(e.target.files).slice(0,4); files.forEach(file=>{ const reader=new FileReader(); reader.onload = ev=>{ const img=document.createElement('img'); img.src=ev.target.result; img.className='photo-thumb'; photoContainer.appendChild(img); }; reader.readAsDataURL(file); }); e.target.value=''; });
// entries
let state = { entries: JSON.parse(localStorage.getItem('fj_entries')||'[]'), lakes: JSON.parse(localStorage.getItem('fj_lakes')||'[]'), currentLake: null }; const entryForm=q('#entryForm'), addBtn=q('#addBtn'), entriesBody=q('#entriesTable tbody'); if(addBtn) addBtn.addEventListener('click', ()=>{ const fd = new FormData(entryForm); const e = { id: Date.now(), time: fd.get('time')||'', date: fd.get('date')||'', species: fd.get('species')||'', weight: fd.get('weight')||'', bait: fd.get('bait')||'', lake: fd.get('lake')||'', peg: fd.get('peg')||'', spot: fd.get('spot')||'' }; state.entries.unshift(e); localStorage.setItem('fj_entries', JSON.stringify(state.entries)); entryForm.reset(); renderEntries(); renderSchedule(); });
function renderEntries(){ if(!entriesBody) return; entriesBody.innerHTML=''; state.entries.forEach(e=>{ const tr=document.createElement('tr'); tr.innerHTML = `<td>${formatDate(e.date)}</td><td>${e.time}</td><td>${escapeHtml(e.species)}</td><td>${escapeHtml(e.weight)}</td><td>${escapeHtml(e.lake)}</td><td>${escapeHtml(e.peg)}</td><td><div style="max-height:2.6em;overflow:hidden">${escapeHtml(e.spot)}</div></td><td><button onclick="deleteEntry(${e.id})">Delete</button></td>`; entriesBody.appendChild(tr); }); }
window.deleteEntry = function(id){ if(!confirm('Delete?')) return; state.entries = state.entries.filter(x=>x.id!==id); localStorage.setItem('fj_entries', JSON.stringify(state.entries)); renderEntries(); renderSchedule(); }
// lakes
const lakesContainer = q('#lakesContainer'), showNotesBtn = q('#showNotesBtn'), notesBox = q('#notesBox'), notesArea = q('#notesArea');
function renderLakes(){ if(!lakesContainer) return; lakesContainer.innerHTML=''; state.lakes.forEach(l=>{ const el = document.createElement('div'); el.className='lake-card'; el.innerHTML = `<div style="flex:1"><strong>${escapeHtml(l.name)}</strong></div><div style="display:flex;gap:8px"><button onclick="toggleLake(${l.id})">Open</button><button onclick="deleteLake(${l.id})">Delete</button></div><div id="body-${l.id}" class="lake-body" style="display:none"></div>`; lakesContainer.appendChild(el); const body = document.getElementById('body-'+l.id); body.innerHTML=''; (l.pegs||[]).forEach(p=>{ const pd=document.createElement('div'); pd.innerHTML = `<div><em>Peg:</em> ${escapeHtml(p.name)} <button onclick="addSpotPrompt(${l.id},${p.id})">+Spot</button></div>`; body.appendChild(pd); p.spots.forEach(s=>{ const sd = document.createElement('div'); sd.style.paddingLeft='12px'; sd.textContent = '• '+s.name; body.appendChild(sd); }); }); }); }
window.toggleLake = function(id){ state.lakes.forEach(l=>{ const b = document.getElementById('body-'+l.id); if(!b) return; if(l.id===id){ b.style.display = b.style.display==='none' ? 'block' : 'none'; state.currentLake = (b.style.display==='block'? id : null); } else { b.style.display='none'; } }); }
window.addSpotPrompt = function(lakeId, pegId){ const name = prompt('Spot name'); if(!name) return; const lake = state.lakes.find(x=>x.id===lakeId); if(!lake) return; const peg = lake.pegs.find(x=>x.id===pegId); if(!peg) return; if((peg.spots||[]).length>=25) return alert('Max spots'); peg.spots.push({id:Date.now(), name}); localStorage.setItem('fj_lakes', JSON.stringify(state.lakes)); renderLakes(); }
window.deleteLake = function(id){ if(!confirm('Delete lake?')) return; state.lakes = state.lakes.filter(x=>x.id!==id); localStorage.setItem('fj_lakes', JSON.stringify(state.lakes)); renderLakes(); }
if(showNotesBtn) showNotesBtn.addEventListener('click', ()=>{ if(!state.currentLake){ alert('Open a lake first to view notes'); return; } const key = 'fj_notes_'+state.currentLake; if(notesBox.style.display==='none'){ notesBox.style.display='block'; notesArea.value = localStorage.getItem(key) || ''; notesArea.focus(); showNotesBtn.textContent='Close'; } else { notesBox.style.display='none'; notesArea.blur(); showNotesBtn.textContent='Notes'; } }); if(notesArea) notesArea.addEventListener('input', ()=>{ if(!state.currentLake) return; localStorage.setItem('fj_notes_'+state.currentLake, notesArea.value); });
// import/export simple
const impExpBtn = q('#impExpBtn'), impExpMenu = q('#impExpMenu'), importX = q('#importX'), exportX = q('#exportX'), exportPdf = q('#exportPdf');
if(impExpBtn) impExpBtn.addEventListener('click', ()=> impExpMenu.style.display = impExpMenu.style.display==='none' ? 'block' : 'none');
if(exportX) exportX.addEventListener('click', ()=>{ const header = ['Date','Time','Species','Weight','Lake','Name','Spot']; const rows = state.entries.map(r=>[r.date,r.time,r.species,r.weight,r.lake,r.peg,r.spot]); const csv = [header,...rows].map(r=>r.map(c=>`"${(c||'').toString().replace(/"/g,'""')}"`).join(',')).join('\n'); const blob = new Blob([csv], {type:'text/csv'}); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'fishing_schedule.csv'; a.click(); });
if(exportPdf) exportPdf.addEventListener('click', ()=>{ const w = window.open('','_blank'); let html = '<html><head><title>Fishing Log</title></head><body>'; html += '<h2>Fishing Log</h2><table border="1" cellpadding="6" cellspacing="0"><tr><th>Date</th><th>Time</th><th>Species</th><th>Weight</th><th>Lake</th><th>Name</th><th>Spot</th></tr>'; state.entries.forEach(r=>{ html += `<tr><td>${formatDate(r.date)}</td><td>${escapeHtml(r.time)}</td><td>${escapeHtml(r.species)}</td><td>${escapeHtml(r.weight)}</td><td>${escapeHtml(r.lake)}</td><td>${escapeHtml(r.peg)}</td><td>${escapeHtml(r.spot)}</td></tr>` }); html += '</table></body></html>'; w.document.write(html); w.document.close(); w.print(); w.close(); });
// helpers
function formatDate(d){ if(!d) return ''; try{ const dt = new Date(d); return String(dt.getDate()).padStart(2,'0') + '/' + String(dt.getMonth()+1).padStart(2,'0') + '/' + String(dt.getFullYear()).slice(2); }catch(e){return d;} }
function escapeHtml(s){ return (s||'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
// init
function renderAll(){ renderEntries(); renderLakes(); }
function init(){ renderAll(); } init(); // initial panel
panels.forEach(p=> p.hidden = p.id !== 'logbook');</script></body></html>